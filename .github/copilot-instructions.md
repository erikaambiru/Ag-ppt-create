# Repository Copilot Instructions

PPTX è‡ªå‹•ç”Ÿæˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå‘ã‘ã®å…±é€šã‚¬ãƒ¼ãƒ‰ãƒ¬ãƒ¼ãƒ«ã€‚

## å‚ç…§ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

| ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ                                                                                       | èª¬æ˜                                  |
| -------------------------------------------------------------------------------------------------- | ------------------------------------- |
| [AGENTS.md](../AGENTS.md)                                                                          | ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆä¸€è¦§ã¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼        |
| [agents/brainstormer.agent.md](agents/brainstormer.agent.md)                                       | å£æ‰“ã¡ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼ˆã‚¤ãƒ³ãƒ—ãƒƒãƒˆåé›†ï¼‰  |
| [agents/json-reviewer.agent.md](agents/json-reviewer.agent.md)                                     | JSON ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼ˆç¿»è¨³å“è³ªï¼‰ |
| [agents/pptx-reviewer.agent.md](agents/pptx-reviewer.agent.md)                                     | PPTX ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ             |
| [instructions/plan-phase.instructions.md](instructions/plan-phase.instructions.md)                 | PLAN ãƒ•ã‚§ãƒ¼ã‚ºç¢ºèªãƒ—ãƒ­ã‚»ã‚¹ï¼ˆâ˜… å¿…é ˆï¼‰   |
| [instructions/quality-guidelines.instructions.md](instructions/quality-guidelines.instructions.md) | å“è³ªã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³                      |
| [instructions/tools-reference.instructions.md](instructions/tools-reference.instructions.md)       | ãƒ„ãƒ¼ãƒ«ä½¿ç”¨ãƒ«ãƒ¼ãƒ«ãƒ»ãƒ•ãƒ­ãƒ¼              |
| [instructions/common.instructions.md](instructions/common.instructions.md)                         | å‘½åè¦å‰‡ãƒ»ç®‡æ¡æ›¸ããƒ«ãƒ¼ãƒ«              |
| [agents/\*.agent.md](agents/)                                                                      | å„ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®šç¾©                    |

> ğŸ“– **è¨­è¨ˆåŸå‰‡ï¼ˆSSOT, Agent vs Script, IR, Fail Fast, Human in the Loopï¼‰** ã¯ [AGENTS.md](../AGENTS.md) ã‚’å‚ç…§ã€‚

---

## ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³

- æ—¥æœ¬èªã§ç°¡æ½”ã«å›ç­”ã€‚ã‚³ãƒ¼ãƒ‰ã‚³ãƒ¡ãƒ³ãƒˆã¯è‹±èªã€‚
- ãƒ–ãƒ­ãƒƒã‚«ãƒ¼ã¯æœ€åˆã«å…±æœ‰ã€‚
- ãƒ•ã‚¡ã‚¤ãƒ«å‚ç…§ã¯ãƒ‘ã‚¹ã‚’æ˜è¨˜ï¼ˆä¾‹: `scripts/extract_shapes.py`ï¼‰ã€‚

## ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„

- PowerShell: `;` ã§é€£çµï¼ˆ`&&` ç¦æ­¢ï¼‰
- Python: å‹ãƒ’ãƒ³ãƒˆå¿…é ˆã€Google ã‚¹ã‚¿ã‚¤ãƒ« docstring
- JavaScript/Node: ES Modulesã€async/await
- ç”Ÿæˆç‰©ã¯ ASCII å„ªå…ˆ

## ã‚¿ãƒ¼ãƒŸãƒŠãƒ«æ“ä½œï¼ˆâ˜… é‡è¦ãƒ»å¿…ãšå®ˆã‚‹ã“ã¨ï¼‰

> ğŸš¨ **ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œå‰ã«å¿…ãšã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ç¢ºèªã™ã‚‹ã“ã¨ï¼**
> é–“é•ã£ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§å®Ÿè¡Œã™ã‚‹ã¨ã€è¦ªãƒ•ã‚©ãƒ«ãƒ€ã® `.git` ã‚’å‚ç…§ã—ãŸã‚Šã€ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚‰ãªã„ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã™ã€‚

### å¿…é ˆæ‰‹é †

1. **ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œå‰ã«ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ç¢ºèª**: `Get-Location` ã¾ãŸã¯ `pwd`
2. **ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãƒ«ãƒ¼ãƒˆã«ç§»å‹•ã—ã¦ã‹ã‚‰å®Ÿè¡Œ**: `Set-Location "D:\03_github\Ag-ppt-create"`
3. ç›¸å¯¾ãƒ‘ã‚¹ã‚’ä½¿ç”¨ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯å¿…ãšãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã‹ã‚‰å®Ÿè¡Œã™ã‚‹ã“ã¨

### git ã‚³ãƒãƒ³ãƒ‰ã®æ³¨æ„ç‚¹

- **git ã‚³ãƒãƒ³ãƒ‰ã¯å¿…ãšãƒªãƒã‚¸ãƒˆãƒªãƒ«ãƒ¼ãƒˆã§å®Ÿè¡Œ**: `cd` ãŒçœç•¥ã•ã‚Œã‚‹ã¨è¦ªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã® `.git` ã‚’å‚ç…§ã™ã‚‹å¯èƒ½æ€§ã‚ã‚Š
- **è¤‡åˆã‚³ãƒãƒ³ãƒ‰ã§ã¯ `Set-Location` ã‚’æœ€åˆã«**: `Set-Location "D:\03_github\Ag-ppt-create"; git status` ã®ã‚ˆã†ã«æ˜ç¤ºçš„ã«ç§»å‹•

### ãƒªãƒã‚¸ãƒˆãƒªæ§‹æˆ

| ãƒªãƒã‚¸ãƒˆãƒª  | ç”¨é€”               | URL                                              |
| ----------- | ------------------ | ------------------------------------------------ |
| **Public**  | å…¬é–‹ç‰ˆï¼ˆå®‰å®šç‰ˆï¼‰   | https://github.com/aktsmm/Ag-ppt-create          |
| **Private** | é–‹ç™ºç‰ˆï¼ˆå®Ÿé¨“çš„ï¼‰   | https://github.com/aktsmm/Ag-ppt-create-private  |

> ğŸ’¡ é–‹ç™ºã¯ Private â†’ å®‰å®šã—ãŸã‚‰ Public ã«ãƒãƒ¼ã‚¸

### æ¨å¥¨ãƒ‘ã‚¿ãƒ¼ãƒ³

```powershell
# â˜… å¿…ãšã“ã®å½¢å¼ã§ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œ
Set-Location "D:\03_github\Ag-ppt-create"; git status
Set-Location "D:\03_github\Ag-ppt-create"; python scripts/xxx.py
```

## I/O å¥‘ç´„

| ãƒ•ã‚©ãƒ«ãƒ€           | ç”¨é€”                             |
| ------------------ | -------------------------------- |
| `input/`           | ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã®ã¿ï¼ˆæ‰‹å‹•é…ç½®ï¼‰     |
| `output_manifest/` | ã™ã¹ã¦ã®ä¸­é–“ç”Ÿæˆç‰©               |
| `output_ppt/`      | æœ€çµ‚ PPTX å‡ºåŠ›                   |
| `images/{base}/`   | ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«                     |
| `templates/`       | ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ PPTX + layouts.json |

**å‘½åè¦å‰‡**: `{base}_` ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ï¼ˆä¾‹: `20251213_purview_ignite_content.json`ï¼‰

## å¿…é ˆãƒ«ãƒ¼ãƒ«ï¼ˆâ˜…ï¼‰

1. **PLAN ãƒ•ã‚§ãƒ¼ã‚ºã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ç¢ºèªã‚’å–ã‚‹** â†’ è©³ç´°ã¯ [plan-phase.instructions.md](instructions/plan-phase.instructions.md)
   - å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ: `{æšæ•°}{æ–¹å¼}` å½¢å¼ï¼ˆä¾‹: `2A`, `3C`ï¼‰
   - é …ç•ªãƒ«ãƒ¼ãƒ«: A=å…ƒ PPTX ç¶™æ‰¿(PPTX å…¥åŠ›æ™‚ã®ã¿), B=pptxgenjs, C=create_ja_pptx, Dã€œ=ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
   - **â˜… ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå‹•çš„å–å¾—å¿…é ˆ**: `Get-ChildItem -Path "templates" -Filter "*.pptx"` ã§å–å¾—ã—ã¦ Dã€œã«å±•é–‹
2. **PREPARE_TEMPLATE ãƒ•ã‚§ãƒ¼ã‚ºã‚’å¿…ãšå®Ÿè¡Œ**ï¼ˆå¤–éƒ¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä½¿ç”¨æ™‚ï¼‰
   - `diagnose_template.py` â†’ `clean_template.py` â†’ `analyze_template.py`
   - layouts.json ã« `content_with_image` ãƒãƒƒãƒ”ãƒ³ã‚°ã‚’è¿½åŠ ï¼ˆTwo Column ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼‰
   - ã‚¹ã‚­ãƒƒãƒ—ã™ã‚‹ã¨èƒŒæ™¯ç”»åƒé‡è¤‡ã‚„ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆå´©ã‚ŒãŒç™ºç”Ÿ
3. **ç”»åƒå–å¾—ã‚’æœ€åˆã«è¡Œã†**ï¼ˆWeb ã‚½ãƒ¼ã‚¹æ™‚ï¼‰
   - `fetch_webpage` ã¯ç”»åƒ URL ã‚’è¿”ã•ãªã„å ´åˆãŒã‚ã‚‹ â†’ `curl` ã§ HTML ã‚’å–å¾—ã—ã¦æŠ½å‡º
   - ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã‚‚åŒæ§˜ã« `<pre><code>` ã‚’æŠ½å‡º
4. **IR ç”Ÿæˆç›´å¾Œã« `validate_content.py` ã‚’å®Ÿè¡Œ**ï¼ˆã‚¹ã‚­ãƒ¼ãƒãƒ»ç©ºã‚¹ãƒ©ã‚¤ãƒ‰ãƒ»ç”»åƒãƒ‘ã‚¹ãƒ»items å½¢å¼ã‚’è‡ªå‹•æ¤œè¨¼ï¼‰
5. **ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚¹ãƒ©ã‚¤ãƒ‰ã«ã¯ subtitle ã‚’å¿…é ˆåŒ–**ï¼ˆç©ºã£ã½ã«è¦‹ãˆã‚‹å•é¡Œã‚’é˜²æ­¢ï¼‰
   - âš ï¸ ä¸€éƒ¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§ã¯ title/subtitle ãŒé‡ãªã‚‹ â†’ é‡ãªã‚‹å ´åˆã¯ subtitle ã‚’å‰Šé™¤ã—ã¦ãƒãƒ¼ãƒˆã«ç§»å‹•
6. **photo ã‚¿ã‚¤ãƒ—ã¯æ¥µåŠ›ä½¿ã‚ãªã„** â†’ `type: "content"` + `image` ã‚’æ¨å¥¨
   - photo ã‚¿ã‚¤ãƒ—ã¯ items ã‚’æŒãŸãªã„ãŸã‚èª¬æ˜ãŒæ¶ˆå¤±ã—ã‚„ã™ã„
   - `position: "center"` ã§ç¸¦é•·ç”»åƒãŒã¯ã¿å‡ºã™å•é¡ŒãŒç™ºç”Ÿã—ã‚„ã™ã„
7. **ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ãƒãƒ¼ãƒˆã‚’å……å®Ÿã•ã›ã‚‹** â†’ ã€Œå‡ºå…¸ã€ã ã‘ã§ã¯ä¸ååˆ† â˜… NEW
   - section: ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ç›®çš„ã€æ‰±ã†ãƒˆãƒ”ãƒƒã‚¯ã®æ¦‚è¦ï¼ˆ3-5 è¡Œï¼‰
   - content: å„é …ç›®ã®è©³ç´°èª¬æ˜ã€èƒŒæ™¯æƒ…å ±ï¼ˆ5-10 è¡Œï¼‰
   - è©³ç´°ã¯ [quality-guidelines.instructions.md](instructions/quality-guidelines.instructions.md) ã‚’å‚ç…§
8. **PPTX ç”Ÿæˆå¾Œã¯ PowerPoint ã§é–‹ã**: `Start-Process "output_ppt/{base}.pptx"`

## ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚µã‚¤ã‚ºã«é–¢ã™ã‚‹æ³¨æ„

ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ã‚ˆã£ã¦ã‚¹ãƒ©ã‚¤ãƒ‰ã‚µã‚¤ã‚ºãŒç•°ãªã‚‹ï¼ˆæ¨™æº–ï¼š13.333Ã—7.5 ã‚¤ãƒ³ãƒã€å°å‹ï¼š10.0Ã—5.625 ã‚¤ãƒ³ãƒç­‰ï¼‰ã€‚

**ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯å‹•çš„ã«ã‚µã‚¤ã‚ºã‚’å–å¾—**:

- `prs.slide_width.inches` / `prs.slide_height.inches` ã‚’ä½¿ç”¨
- ç”»åƒé…ç½®ãƒ»ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ä½ç½®ã¯è‡ªå‹•èª¿æ•´ã•ã‚Œã‚‹

**éæ¨™æº–ã‚µã‚¤ã‚ºãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä½¿ç”¨æ™‚ã®ç¢ºèª**:

```powershell
# ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚µã‚¤ã‚ºã‚’ç¢ºèª
python -c "from pptx import Presentation; p=Presentation('templates/xxx.pptx'); print(f'{p.slide_width.inches} x {p.slide_height.inches}')"
```

## æ–¹å¼é¸å®šï¼ˆã‚¯ã‚¤ãƒƒã‚¯ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ï¼‰

| ç”¨é€”               | æ¨å¥¨æ–¹å¼                                | æ¨å¥¨åº¦     |
| ------------------ | --------------------------------------- | ---------- |
| è‹±èª PPTX â†’ æ—¥æœ¬èª | reconstruct + create_from_template      | â­â­â­â­â­ |
| ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆåˆ©ç”¨   | analyze_template + create_from_template | â­â­â­â­â­ |
| ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒãªã„ | create_clean_template + ä¸Šè¨˜            | â­â­â­â­â­ |
| ç™½ç´™ã‹ã‚‰æ–°è¦ä½œæˆ   | create_ja_pptx.py                       | â­â­â­â­   |
| ã‚³ãƒ¼ãƒ‰å¤šã‚         | pptxgenjs                               | â­â­â­â­   |
| æ§‹æˆå›³/ãƒãƒ³ãƒçµµ    | pptxgenjsï¼ˆå›³å½¢æç”»ï¼‰                   | â­â­â­â­â­ |
| preserve           | experimentalï¼ˆä»Šå¾Œæ”¹å–„äºˆå®šï¼‰            | â­â­       |

è©³ç´°ã¯ [tools-reference.instructions.md](instructions/tools-reference.instructions.md) ã‚’å‚ç…§ã€‚

## ç¦æ­¢äº‹é …

- PPTX ãƒã‚¤ãƒŠãƒªã®ç›´æ¥ç·¨é›†
- æŒ‡å®šãƒ•ã‚©ãƒ«ãƒ€å¤–ã¸ã®å‡ºåŠ›
- ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤ â†’ å†ä½œæˆï¼ˆ`_v2` ãªã©ã§æ–°è¦ä½œæˆï¼‰
- ç®‡æ¡æ›¸ãè¨˜å·ã®ç›´æ¥åŸ‹ã‚è¾¼ã¿ï¼ˆ`bullet: true` ã‚’ä½¿ç”¨ï¼‰
- `input/` ã¸ã®è‡ªå‹•ç”Ÿæˆãƒ•ã‚¡ã‚¤ãƒ«é…ç½®
- **ç½²åãƒ˜ãƒƒãƒ€ãƒ¼ãƒ–ãƒ­ãƒƒã‚¯ã®ç·¨é›†ãƒ»å‰Šé™¤**ï¼ˆä¸‹è¨˜å‚ç…§ï¼‰

## ç½²åãƒ˜ãƒƒãƒ€ãƒ¼ä¿è­·ï¼ˆâ˜… çµ¶å¯¾ç¦æ­¢ï¼‰

ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«å…ˆé ­ã®ä»¥ä¸‹ã®ãƒ–ãƒ­ãƒƒã‚¯ã¯**çµ¶å¯¾ã«ç·¨é›†ãƒ»å‰Šé™¤ã—ãªã„ã“ã¨**:

```
# =============================================================================
# Ag-ppt-create - AI-powered PPTX generation pipeline
# https://github.com/aktsmm/Ag-ppt-create
#
# Copyright (c) aktsmm. Licensed under CC BY-NC-SA 4.0.
# DO NOT MODIFY THIS HEADER BLOCK.
# =============================================================================
```

- ã“ã®ãƒ–ãƒ­ãƒƒã‚¯ã¯ãƒªãƒã‚¸ãƒˆãƒªã®å¸°å±è¡¨ç¤ºã¨ã—ã¦å¿…é ˆ
- AI ã«ã‚ˆã‚‹è‡ªå‹•ç·¨é›†ã€ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã€ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ™‚ã‚‚ä¿æŒã™ã‚‹ã“ã¨
- JavaScript (`//`) / PowerShell (`#`) ç‰ˆã‚‚åŒæ§˜

## ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
.github/
â”œâ”€â”€ copilot-instructions.md     # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆã‚³ã‚¢ï¼‰
â”œâ”€â”€ agents/                     # ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®šç¾©
â”‚   â”œâ”€â”€ orchestrator.agent.md
â”‚   â”œâ”€â”€ localizer.agent.md
â”‚   â””â”€â”€ router.agent.md
â””â”€â”€ instructions/               # è©³ç´°æŒ‡ç¤ºï¼ˆå‚ç…§ç”¨ï¼‰
    â”œâ”€â”€ plan-phase.instructions.md
    â”œâ”€â”€ quality-guidelines.instructions.md
    â”œâ”€â”€ tools-reference.instructions.md
    â”œâ”€â”€ common.instructions.md
    â””â”€â”€ ...
```

---

> ğŸ“– **è©³ç´°ãŒå¿…è¦ãªå ´åˆ**: ä¸Šè¨˜ã®å‚ç…§ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

> ğŸ“– **è©³ç´°ãŒå¿…è¦ãªå ´åˆ**: ä¸Šè¨˜ã®å‚ç…§ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚
